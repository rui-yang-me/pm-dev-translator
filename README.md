# PM-Dev Translator

产品经理与开发工程师的沟通桥梁 —— 基于 AI 的双向翻译工具。

## 快速开始

### 安装依赖

```bash
cd worker
npm install
```

### 配置 API Key

**本地开发：**

```bash
# 在 worker 目录下创建 .dev.vars 文件
echo "DEEPSEEK_API_KEY=your_api_key_here" > worker/.dev.vars
```

**生产环境（Cloudflare Workers）：**

```bash
cd worker
wrangler secret put DEEPSEEK_API_KEY
# 按提示输入你的 API Key
```

### 运行项目

**本地开发：**

```bash
# 启动 Worker（后端）
cd worker
npm run dev
# Worker 将在 http://localhost:8787 启动

# 前端直接用浏览器打开
open frontend/index.html
```

**部署到 Cloudflare：**

```bash
# 部署 Worker
cd worker
npm run deploy

# 部署 Pages（前端）
wrangler pages deploy frontend --project-name=pm-dev-translator
```

## 功能说明

### 这个工具做什么？

PM-Dev Translator 解决产品经理和开发工程师之间的"语言障碍"问题：

- **PM 说的话**：用户想要更快的加载速度
- **Dev 需要知道的**：QPS 要求、缓存策略、CDN 配置、性能指标阈值

- **Dev 说的话**：我们引入了 Redis 缓存层，命中率 95%
- **PM 需要知道的**：页面加载快了 3 倍，用户等待时间从 3 秒降到 1 秒

### 核心功能

| 功能 | 说明 |
|------|------|
| **PM → Dev** | 将业务需求转化为技术方案，补充算法、架构、性能要求、工作量评估 |
| **Dev → PM** | 将技术成果转化为业务价值，突出用户体验改善、商业收益、产品机会 |
| **流式输出** | 实时显示翻译结果，无需等待完整响应 |
| **Markdown 渲染** | 输出结构化、易读的格式化内容 |

## 测试用例

### 用例 1：PM → Dev（产品需求翻译为技术方案）

**输入（产品视角）：**

```
我需要在门锁app中实现一个AI智能客服，提升用户体验。
```

**翻译效果（开发视角）：**

~~~
# AI智能客服技术方案

## 一、需求分析与技术解读

### 1.1 需求核心要素
- **功能定位**：门锁App内置AI客服，提供7x24小时智能问答服务
 **核心场景**：门锁使用问题、故障排查、操作指导、账户管理、安全咨询
- **交互形式**：文本对话为主，可扩展语音/图片识别
- **集成方式**：App内嵌对话界面，与现有用户系统打通

### 1.2 需要产品明确的细节
1. **知识范围边界**：仅限门锁相关还是包含智能家居全品类？
2. **多轮对话深度**：简单QA还是复杂故障诊断（需多轮交互）？
3. **人工转接机制**：AI无法解决时如何转人工？响应时间要求？
4. **多语言支持**：是否需要支持多语言（英语、方言等）？
5. **合规要求**：用户数据隐私保护、对话记录存储期限？

## 二、技术方案建议

### 2.1 系统架构设计
```markdown
┌─────────────────────────────────────────┐
│           客户端（门锁App）              │
│  ┌──────────────────────────────────┐  │
│  │ 对话UI组件 + SDK（消息收发/渲染） │  │
└──┴──────────────────────────────────┴──┘
                    ↓ HTTPS/WebSocket
┌─────────────────────────────────────────┐
│            API网关层（负载均衡）         │
│   • 请求路由 • 限流熔断 • 身份认证       │
└─────────────────────────────────────────┘
                    ↓
┌─────────────────────────────────────────┐
│            AI服务核心层                  │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  │
│  │意图识别 │  │对话管理 │  │知识检索 │  │
│  │模块     │  │引擎     │  │模块     │  │
│  └─────────┘  └─────────┘  └─────────┘  │
└─────────────────────────────────────────┘
                    ↓
┌─────────────────────────────────────────┐
│           数据与知识层                   │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  │
│  │向量数据库│  │关系型DB │  │知识图谱 │  │
│  │(FAQ检索) │  │(用户/对话)│  │(故障树) │  │
│  └─────────┘  └─────────┘  └─────────┘  │
└─────────────────────────────────────────┘
```

### 2.2 技术选型建议

#### 自然语言处理层
- **意图识别**：BERT/ERNIE微调（分类准确率>95%）
- **实体抽取**：BiLSTM-CRF或基于预训练模型的NER
- **对话管理**：基于有限状态机（FSM）或深度强化学习（复杂场景）
- **知识检索**：FAISS + Sentence-BERT（语义相似度匹配）

#### 后端服务
- **微服务框架**：Spring Cloud Alibaba / gRPC
- **API网关**：Kong / Spring Cloud Gateway
- **消息队列**：RabbitMQ / Kafka（用于异步处理对话日志）
- **缓存**：Redis（会话状态管理）

#### 数据存储
- **向量数据库**：Milvus / Pinecone（FAQ语义检索）
- **关系数据库**：MySQL/PostgreSQL（用户数据、对话记录）
- **知识图谱**：Neo4j（故障诊断推理）
- **日志存储**：Elasticsearch（对话分析）

#### 客户端SDK
- **Android**：Kotlin + 自研SDK或集成第三方IM SDK
- **iOS**：Swift + 同上
- **跨平台**：考虑Flutter组件（如已有跨端架构）

### 2.3 数据处理流程

用户输入 → 文本预处理 → 意图识别 → 实体抽取
    ↓
[简单问题] → FAQ语义检索 → 答案生成 → 回复用户
    ↓
[复杂问题] → 知识图谱推理 → 多轮对话管理 → 逐步引导
    ↓
[无法解决] → 人工客服转接 → 会话上下文传递

## 三、关键技术问题

### 3.1 技术难点
1. **领域适应性问题**：通用大模型在门锁专业领域表现不佳，需要：
   - 收集门锁相关QA语料（至少5000对）
   - 领域预训练或微调
   - 构建门锁故障诊断知识图谱

2. **多轮对话一致性**：
   - 会话状态管理（Redis存储会话上下文）
   - 指代消解（如"它"指代哪个设备）
   - 对话历史窗口设计（最近N轮）

3. **离线场景支持**：
   - 部分核心FAQ是否支持本地化？
   - 网络异常时的降级方案

### 3.2 依赖条件
1. **数据依赖**：
   - 历史客服对话记录（脱敏后用于训练）
   - 产品手册、故障代码表
   - 用户操作日志（匿名化分析）

2. **第三方服务**：
   - 语音识别ASR（如扩展语音客服）
   - 图像识别（如用户上传故障图片）
   - 短信/推送服务（异步通知）

## 四、性能与约束

### 4.1 性能指标（需产品确认）
| 指标 | 目标值 | 备注 |
|------|--------|------|
| 平均响应时间 | < 1秒 | 端到端延迟 |
| P99响应时间 | < 2秒 | 尾部延迟 |
| 并发对话数 | 1000+ | 峰值支持 |
| 意图识别准确率 | > 92% | 上线初期 |
| 问题解决率 | > 70% | 无需转人工比例 |

### 4.2 数据规模预估
- **日活用户**：假设10万DAU
- **客服使用率**：假设5%（5000用户/天）
- **平均对话轮次**5轮/会话
- **日均消息量**：2.5万条
- **存储需求**：对话记录约500MB/天

### 4.3 实时性要求
- **对话响应**：实时（<1秒）
- **模型更新**准实时（每日增量更新）
- **知识库更新**：准实时（产品变更后24小时内同步）

## 五、工作量评估

### 5.1 开发周期（总约12-16周）
| 阶段 | 周期 | 主要任务 | 人力 |
|------|------|----------|------|
| **第一阶段：MVP** | 4-5周 | 基础架构、FAQ检索、简单对话 | 后端3人，前端2人，算法2人 |
| **第二阶段：增强** | 4-5周 | 意图识别优化、多轮对话、知识图谱 | 后端2人，算法3人 |
| **第三阶段：完善** | 3-4周 | 人工转接、数据分析、性能优化 | 后端2人，前端1人，测试2人 |
| **第四阶段：迭代** | 持续 | A/B测试、模型优化、功能扩展 | 算法2人，后端1人 |

### 5.2 人力资源需求
- **后端开发**：3人（微服务、API、数据层）
- **前端开发**：2人（App集成、UI组件）
- **算法工程师**：3人（NLP模型、知识图谱）
- **测试工程师**：2人（功能、性能、兼容性）
- **运维工程师**：1人（部署、监控）

### 5.3 风险与缓解
1. **模型效果不达预期**：先上线基于规则的FAQ，逐步引入AI
2. **用户接受度低**：设计友好的引导和明确的AI标识
3. **数据隐私风险**：对话数据加密存储，用户可删除记录

## 六、实施建议

### 6.1 分阶段上线策略
1. **V1.0**：基于检索的FAQ问答（覆盖80%高频问题）
2. **V1.5**：增加意图识别和简单多轮对话
3. **V2.0**：集成知识图谱的故障诊断
4. **V2.5**：扩展语音、图片识别能力

### 6.2 监控与评估体系
- **技术指标**：响应时间、错误率、服务可用性
- **业务指标**：问题解决率、转人工率、用户满意度
- **模型指标**：意图识别准确率、检索召回率

### 6.3 需要产品进一步明确的问题
1. 首期预算范围（影响云服务选型和模型训练规模）
2. 是否要求与现有客服系统（如有）数据打通？
3. 是否支持用户上传图片识别故障？
4. 是否需要情感分析识别用户不满情绪？
5. 客服对话风格要求（专业严谨 vs 亲切友好）？

---

**输出说明**：本方案基于通用智能客服架构设计，具体实施需根据实际业务需求调整。建议先启动数据收集和标注工作，同时并行开发基础架构。
~~~

---

### 用例 2：Dev → PM（技术成果翻译为业务价值）

**输入（开发视角）：**

```
我们把用户列表接口从MySQL直查改成了Redis缓存，缓存命中率95%，P99延迟从800ms降到了50ms，同时数据库CPU使用率从80%降到了30%
```

**翻译效果（产品视角）：**

~~~
# 技术方案业务价值解读

## 📊 核心成果摘要
我们优化了用户信息获取机制，现在系统响应速度大幅提升，后台资源消耗显著降低，为用户提供更流畅的体验。

## 👥 用户体验影响

### 用户能感知到的变化
- **页面加载更快**：用户查看个人信息、浏览用户列表时，页面响应速度明显提升
- **操作更流畅**：涉及用户信息的交互（如搜索用户、查看用户资料）几乎没有等待感
- **高峰期体验稳定**：即使在访问高峰时段，用户也不会感受到明显的系统卡顿

### 对核心使用场景的改善
- **用户管理场景**：管理员查看用户列表、筛选用户的操作响应速度提升16倍
- **社交互动场景**：用户查看他人资料、关注列表的体验更加顺畅
- **搜索场景**：用户搜索相关功能响应更加及时

### 具体的体验提升点
- 原来需要接近1秒的等待时间，现在几乎瞬间完成
- 复杂查询（如多条件筛选用户）的响应速度同样大幅提升
- 整体系统感觉更加"轻快"和"即时"

## 💼 业务价值

### 支撑的业务目标
- **提升用户满意度**：减少等待时间直接改善用户体验
- **增强系统稳定性**：降低核心数据库压力，提高系统整体可靠性
- **支撑用户增长**：系统现在能承载更多并发用户访问

### 潜在的商业收益
- **降低用户流失**：页面响应速度每提升100ms，用户留存率可提升1-2%
- **提高运营效率**：管理后台操作更流畅，提升运营团队工作效率
- **节省基础设施成本**：数据库资源消耗降低62.5%，可支撑更多用户而不需扩容

### 可量化的业务指标改善
- **用户满意度指标**：页面加载时间满意度预计提升20-30%
- **运营效率指标**：管理员处理用户相关任务时间减少40%
- **系统容量指标**：同等硬件配置下可支持用户量提升2-3倍
- **成本效益指标**：数据库资源成本节省50%以上

## 🚀 产品机会

### 新增功能的可能性
- **实时用户状态展示**：现在可以轻松实现用户在线状态、最后活跃时间等实时信息
- **更丰富的用户画像**：可考虑增加用户标签、行为分析等需要快速读取的功能
- **个性化推荐系统**：为基于用户特征的个性化推荐奠定技术基础

### 可支撑的产品规划
- **社交功能扩展**：支持更复杂的用户关系网络和社交互动
- **实时协作功能**：为团队协作、即时通讯等实时性要求高的功能提供技术保障
- **大数据分析看板**：可考虑开发实时的用户行为分析仪表盘

### 竞争优势的提升
- **响应速度优势**：相比竞品，我们的用户相关操作响应速度可能成为差异化优势
- **规模化能力**：为未来用户量快速增长做好了技术准备
- **功能扩展性**：为开发更多依赖快速用户数据访问的创新功能打下基础

## ⚠️ 风险与代价

### 用户可能感知到的变化或影响
- **数据延迟风险**：极少数情况下（5%概率），用户看到的信息可能不是最新的（通常延迟在几秒内）
- **需要用户教育**：如果涉及关键信息（如余额、积分），需要明确提示"实时更新中"

### 需要配合的产品动作
1. **监控机制建立**：需要产品配合定义关键用户体验指标监控
2. **用户引导优化**：对于可能的数据延迟情况，设计友好的加载状态和提示
3. **功能优先级调整**：可考虑将依赖快速用户数据的功能提前开发

### 时间线和里程碑
- **立即生效**：所有用户相关功能的响应速度已提升
- **1周内**：建立用户体验监控指标
- **1个月内**：基于新能力规划下一阶段产品功能
- **长期**：持续优化缓存策略，将命中率从95%提升至更高水平

## 📈 总结建议
**这对用户意味着**：更快速、更流畅的产品体验，几乎感受不到等待时间。

**这对业务意味着**：更高的用户满意度、更低的运营成本、更强的系统扩展能力，以及开发创新功能的技术基础。

建议产品团队：
1. 立即开始监控用户体验指标变化
2. 规划利用这一技术优势的新功能
3. 考虑如何将这一技术优势转化为市场宣传点
~~~

---

## 提示词设计说明

### 如何让 AI 理解"产品视角"和"开发视角"的差异？

核心策略是 **角色扮演 + 结构化输出框架**：

#### 1. 明确角色定位

```
PM → Dev: "你是一位资深技术架构师"
Dev → PM: "你是一位懂技术的产品总监"
```

选择"架构师"而非普通开发，是因为架构师能从更高维度思考技术方案；选择"懂技术的产品总监"而非纯产品经理，是因为需要准确理解技术内容才能翻译。

#### 2. 定义翻译维度

| PM → Dev | Dev → PM |
|----------|----------|
| 技术方案建议 | 用户体验影响 |
| 关键技术问题 | 业务价值 |
| 性能与约束 | 产品机会 |
| 工作量评估 | 风险与代价 |

这些维度的设计来自真实工作场景：PM 和 Dev 开会时，双方最常互相追问的就是这些方面。

#### 3. 语言风格切换

```
PM → Dev: "使用技术术语，但保持清晰"
Dev → PM: "避免技术术语，使用业务语言"
```

### 提示词中的关键设计点

| 设计点 | 说明 | 示例 |
|--------|------|------|
| **主动补充** | 不只是翻译，还要补充对方视角缺失的信息 | Dev 关心性能指标，PM 不会主动提供 → 提示 AI 主动询问 |
| **识别模糊点** | 主动发现需求中不明确的地方 | "需要产品明确的技术细节" |
| **可落地导向** | 避免泛泛而谈，给出具体建议 | "给出可落地的技术建议" |
| **视角转换** | 将指标转化为对方能理解的描述 | "将技术指标转化为用户/业务视角的描述" |
| **突出价值** | 每个信息都要回答"这对我有什么用" | "突出'这对用户/业务意味着什么'" |

### 设计思路总结

```
传统翻译：A 语言 → B 语言（字面转换）
本工具：A 视角 → B 视角（思维方式转换 + 信息补充）
```

关键洞察：PM 和 Dev 的沟通问题不是"听不懂对方的话"，而是"不知道对方需要什么信息"。因此提示词的核心是引导 AI **主动补充对方视角所需的信息维度**。

## 技术架构

```
┌─────────────────┐     ┌─────────────────────┐     ┌─────────────────┐
│                 │     │                     │     │                 │
│  Frontend       │────▶│  Cloudflare Worker  │────▶│  DeepSeek API   │
│  (静态页面)      │ SSE │  (Hono 框架)         │     │  (LLM)          │
│                 │◀────│                     │◀────│                 │
└─────────────────┘     └─────────────────────┘     └─────────────────┘
   Cloudflare Pages         流式响应处理              deepseek-chat
```

## License

MIT
